{% extends 'AceEditorBundle:Default:container.html.twig' %}
{% block title "Account Options" %}
{% block mainspan %}
<script src={{ asset("validation/jquery.validate.js") }} type="text/javascript"></script>
<!--<script src={{ asset("validation/jquery.validate.functions.js") }} type="text/javascript"></script>-->
<script type="text/javascript">
            /* <![CDATA[ */
            Query(function(){
                jQuery("#email").validate({
                    expression: "if (VAL.match(/^[^\\W][a-zA-Z0-9\\_\\-\\.]+([a-zA-Z0-9\\_\\-\\.]+)*\\@[a-zA-Z0-9_]+(\\.[a-zA-Z0-9_]+)*\\.[a-zA-Z]{2,4}$/)) return true; else return false;",
                    message: "Please enter a valid Email address"
                });
                jQuery("#new_pass").validate({
                    expression: "if (VAL.length > 5 && VAL) return true; else return false;",
                    message: "Password must be at least 6 characters"
                });
                jQuery("#confirm_new_pass").validate({
                    expression: "if ((VAL == jQuery('#ValidPassword').val()) && VAL) return true; else return false;",
                    message: "Passwords do not match!"
                });
				//jQuery('form#form').validated(function(){
				//	alert("Use this call to make AJAX submissions.");
				//});
            });
            /* ]]> */
        </script>

<h2>User Account Options</h2>
<hr />
<script type="text/javascript" charset="utf-8">
function myfunc()
{
	if($("#new_pass").val() == $("#confirm_new_pass").val())
	{
		if($("#new_pass").val() == "")
		{
			$(".passwords").removeClass("error").removeClass("success");
			$(".password_signs").removeClass("icon-ok").removeClass("icon-remove").addClass("icon-exclamation-sign");						
		}
		else
		{
			$(".passwords").removeClass("error").addClass("success");
			$(".password_signs").removeClass("icon-exclamation-sign").removeClass("icon-remove").addClass("icon-ok");			
		}
	}
	else
	{
		$(".passwords").removeClass("success").addClass("error");			
		$(".password_signs").removeClass("icon-exclamation-sign").removeClass("icon-ok").addClass("icon-remove");			
	}
	$(".password_signs").removeClass("password_signs").addClass("password_signs");			
};
</script>
Change your details, then click 'save' to save your changes.<br /><br />
<form name="form" id="form" action="{{ path('AceEditorBundle_homepage') }}">
<div class="row-fluid">
	<div class="span4">
		<div class="control-group">
			<label class="control-label" for="uname"><strong>Username</strong></label>
			<div class="controls">
				<div class="input-prepend">
					<span class="add-on">	<i class="icon-user"></i></span>
					<input class="input-large" type="text" name="username" id="uname" value="{{ username }}" disabled/>
				</div>
			</div>
		</div>
		<div class="control-group">
			<label class="control-label" for="fname"><strong>Firstname</strong></label>
			<div class="controls">
				<div class="input-prepend">
					<span class="add-on">F</span>
					<input class="input-large" type="text" name="firstname" id="fname" value="{{ settings.getFirstname() }}" />
				</div>
			</div>
		</div>
		<div class="control-group">
			<label class="control-label" for="lname"><strong>Lastname</strong></label>
			<div class="controls">
				<div class="input-prepend">
					<span class="add-on">L</span>
					<input class="input-large" type="text" name="lastname" id="lname" value="{{ settings.getLastname() }}" />
				</div>
			</div>
		</div>
		<div class="control-group">
			<label class="control-label" for="email"><strong>E-mail</strong></label>
			<div class="controls">
				<div class="input-prepend">
					<span class="add-on">	<i class="icon-envelope"></i></span>
					<input class="input-large" type="text" name="email" id="email" value="{{ settings.getEmail() }}" />
				</div>
			</div>
		</div>
		<div class="control-group">
			<label class="control-label" for="tweet"><strong>Twitter</strong></label>
			<div class="controls">
				<div class="input-prepend">
					<span class="add-on">@</span>
					<input class="input-large" type="text" name="tweet" id="tweet" value="{{ settings.getTwitter() }}" />
				</div>
			</div>
		</div>
	</div>
	<div class="span4">
		<div class="control-group">
			<label class="control-label" for="old_pass"><strong>Old Password</strong></label>
			<div class="controls">
				<div class="input-prepend">
					<span class="add-on">	<i class="icon-exclamation-sign"></i></span>
					<input class="input-large" type="password" name="old_pass" id="old_pass" value="" />
				</div>
			</div>
		</div>
		<div class="passwords control-group">
			<label class="control-label" for="new_pass"><strong>New Password</strong></label>
			<div class="controls">
				<div class="input-prepend">
					<span class="add-on">	<i class="icon-exclamation-sign password_signs"></i></span>
					<input class="input-large" type="password" name="new_pass" id="new_pass" value="" onkeyup="myfunc()"/>
				</div>
			</div>
		</div>
		<div class="passwords control-group">
			<label class="control-label" for="confirm_new_pass"><strong>Confirm New Password</strong></label>
			<div class="controls">
				<div class="input-prepend">
					<span class="add-on"><i class="icon-exclamation-sign password_signs"></i></span>
					<input class="input-large" type="password" name="confirm_new_pass" id="confirm_new_pass" value=""  onkeyup="myfunc()" />
				</div>
			</div>
		</div>
	</div>
</div>
<hr />
<input class="btn btn-primary" type="button" id="modify" value="Save Changes" />
<input class="btn" type="submit" id="cancel" value="Cancel" />
</form>

<script>
$(document).ready(function()
	{	
		$("#modify").click(function() 
		{
			//construct array name=>value from form fields
			var items = {};
			$.each($('#form').serializeArray(),
			function(i, field)
			{
    			items[field.name] = field.value;
			});

			$.post("{{ path('AceEditorBundle_setoptions') }}", {data: items },
			function(data)
			{
				alert("Profile Updated: " + data);
			});
		});
	});
</script>

{% endblock %}